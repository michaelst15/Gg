# ===============================================
# Cek Koneksi SQL Server 2008
# File: cek_koneksi_sql2008.ps1
# ===============================================

param(
    [string]$ServerName = "localhost",    # Nama atau IP server SQL
    [string]$Database   = "master",       # Nama database untuk tes
    [string]$UserName   = "",              # Kosongkan untuk Windows Authentication
    [string]$Password   = ""               # Kosongkan untuk Windows Authentication
)

Write-Host "Menguji koneksi ke SQL Server: $ServerName / Database: $Database" -ForegroundColor Cyan

try {
    # Tentukan connection string
    if ([string]::IsNullOrWhiteSpace($UserName)) {
        # Windows Authentication
        $connectionString = "Server=$ServerName;Database=$Database;Integrated Security=True;"
    } else {
        # SQL Authentication
        $connectionString = "Server=$ServerName;Database=$Database;User ID=$UserName;Password=$Password;"
    }

    # Load library SQLClient
    Add-Type -AssemblyName "System.Data"

    # Buat koneksi
    $connection = New-Object System.Data.SqlClient.SqlConnection
    $connection.ConnectionString = $connectionString

    $connection.Open()
    Write-Host "✅ Koneksi berhasil!" -ForegroundColor Green
    $connection.Close()
}
catch {
    Write-Host "❌ Koneksi gagal: $($_.Exception.Message)" -ForegroundColor Red
}
